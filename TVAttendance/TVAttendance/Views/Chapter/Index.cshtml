@model IEnumerable<TVAttendance.Models.Chapter>

@{
    ViewData["Title"] = "Manage Chapters";
    List<string> locations = ViewBag.Locations as List<string> ?? new List<string>();

    // Ensure "All Locations" is added only if it's not already in the list
    if (!locations.Contains("All Locations"))
    {
        locations.Insert(0, "All Locations");
    }
}

<h1>Manage Chapters</h1>

<div class="d-flex align-items-center gap-3 mb-3">
    <!-- Create Button -->
    <a class="btn btn-outline-success" asp-action="Create">Create New</a>

    <!-- Filter Label & Dropdown (aligned inline) -->
    <form method="get" class="d-flex align-items-center">
        <label class="fw-bold mb-0 me-2">Filter by Location:</label>
        <select name="locationFilter" class="form-control w-auto" onchange="this.form.submit();">
            @foreach (var city in locations)
            {
                    <option value="@city" selected="@(city == ViewBag.SelectedLocation ? "selected" : null)">@city</option>
            }
        </select>
    </form>
</div>

<table class="table">
    <thead>
        <tr>
            <th>@Html.DisplayNameFor(model => model.City)</th>
            <th>@Html.DisplayNameFor(model => model.Director)</th>
            <th>Actions</th>
        </tr>
    </thead>

    <tbody>
        @foreach (var item in Model)
        {
                <tr>
                    <td>@Html.DisplayFor(modelItem => item.City)</td>
                    <td>@Html.DisplayFor(modelItem => item.Director.FullName)</td>
                    <td>
                        <div class="d-flex gap-2">
                            <a class="btn btn-outline-primary" asp-action="Edit" asp-route-id="@item.ID">Edit</a>
                            <a class="btn btn-outline-primary" asp-action="Details" asp-route-id="@item.ID">Details</a>
                        </div>
                    </td>
                </tr>
        }
    </tbody>
</table>
